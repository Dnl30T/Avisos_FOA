<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Avisos da Turma - Visualização</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .urgency-alta {
        border-left: 4px solid #ef4444;
      }
      .urgency-media {
        border-left: 4px solid #f59e0b;
      }
      .urgency-baixa {
        border-left: 4px solid #10b981;
      }
      .deadline-near {
        box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        animation: pulse-red 2s infinite;
      }
      .category-provas {
        background: linear-gradient(135deg, #fef3c7, #fcd34d);
      }
      .category-trabalhos {
        background: linear-gradient(135deg, #dbeafe, #60a5fa);
      }
      .category-comunicados {
        background: linear-gradient(135deg, #f3e8ff, #a78bfa);
      }
      .category-noticias {
        background: linear-gradient(135deg, #ecfdf5, #34d399);
      }
      .category-divulgacao {
        background: linear-gradient(135deg, #fff1f2, #fb7185);
      }

      @keyframes pulse-red {
        0%,
        100% {
          box-shadow: 0 0 20px rgba(239, 68, 68, 0.3);
        }
        50% {
          box-shadow: 0 0 30px rgba(239, 68, 68, 0.6);
        }
      }

      .fade-in {
        animation: fadeIn 0.5s ease-in;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .loading-skeleton {
        background: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
      }

      @keyframes loading {
        0% {
          background-position: 200% 0;
        }
        100% {
          background-position: -200% 0;
        }
      }

      /* Filter Collapse Animation */
      .filter-content {
        overflow: hidden;
        transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
        max-height: 0;
        opacity: 0;
      }

      .filter-content.expanded {
        max-height: 300px;
        opacity: 1;
      }

      /* Filter Toggle Icon Animation */
      .filter-toggle-icon {
        transition: transform 0.3s ease;
      }

      .filter-toggle-icon.rotated {
        transform: rotate(-180deg);
      }

      /* Active Filter Flags */
      .filter-flag {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        color: white;
        font-size: 0.75rem;
        padding: 0.25rem 0.5rem;
        border-radius: 9999px;
        display: inline-flex;
        align-items: center;
        gap: 0.25rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease;
        animation: flagFadeIn 0.3s ease-out;
        max-width: 200px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      @media (min-width: 640px) {
        .filter-flag {
          font-size: 0.875rem;
          padding: 0.375rem 0.75rem;
          gap: 0.375rem;
          max-width: none;
        }
      }

      .filter-flag:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
      }

      .filter-flag-remove {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        width: 16px;
        height: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: background 0.2s ease;
        flex-shrink: 0;
      }

      @media (min-width: 640px) {
        .filter-flag-remove {
          width: 18px;
          height: 18px;
        }
      }

      .filter-flag-remove:hover {
        background: rgba(255, 255, 255, 0.3);
      }

      .filter-flag-remove i {
        font-size: 12px;
      }

      @media (min-width: 640px) {
        .filter-flag-remove i {
          font-size: 14px;
        }
      }

      /* Category-specific flag colors */
      .filter-flag.categoria-provas {
        background: linear-gradient(135deg, #f59e0b, #d97706);
      }

      .filter-flag.categoria-trabalhos {
        background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      }

      .filter-flag.categoria-comunicados {
        background: linear-gradient(135deg, #8b5cf6, #7c3aed);
      }

      .filter-flag.categoria-noticias {
        background: linear-gradient(135deg, #10b981, #059669);
      }

      .filter-flag.categoria-divulgacao {
        background: linear-gradient(135deg, #ef4444, #dc2626);
      }

      /* Urgency-specific flag colors */
      .filter-flag.urgencia-alta {
        background: linear-gradient(135deg, #ef4444, #dc2626);
      }

      .filter-flag.urgencia-media {
        background: linear-gradient(135deg, #f59e0b, #d97706);
      }

      .filter-flag.urgencia-baixa {
        background: linear-gradient(135deg, #10b981, #059669);
      }

      /* Dependency flag */
      .filter-flag.dependencia {
        background: linear-gradient(135deg, #f97316, #ea580c);
      }

      /* Flag Animation */
      @keyframes flagFadeIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .flag-remove-animation {
        animation: flagFadeOut 0.2s ease-out forwards;
      }

      @keyframes flagFadeOut {
        from {
          opacity: 1;
          transform: scale(1);
        }
        to {
          opacity: 0;
          transform: scale(0.8);
        }
      }

      /* Additional Responsive Utilities */
      @media (max-width: 640px) {
        .urgency-alta,
        .urgency-media,
        .urgency-baixa {
          border-left-width: 3px;
        }

        .material-icons {
          vertical-align: middle;
        }

        /* Improve touch targets */
        button, .filter-flag-remove {
          min-height: 44px;
          min-width: 44px;
        }

        .filter-flag-remove {
          min-height: 32px;
          min-width: 32px;
        }
      }

      /* Better text wrapping for long content */
      .break-words {
        word-wrap: break-word;
        word-break: break-word;
        hyphens: auto;
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Focus states for accessibility */
      button:focus,
      select:focus,
      input:focus {
        outline: 2px solid #3b82f6;
        outline-offset: 2px;
      }

      /* Improved contrast for small screens */
      @media (max-width: 640px) {
        .text-gray-500 {
          color: #4b5563;
        }
        
        .text-gray-600 {
          color: #374151;
        }
      }
    </style>
  </head>
  <body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
          <h1 class="text-xl sm:text-2xl font-bold text-gray-900">Avisos da Turma</h1>
          <div class="flex flex-col sm:flex-row items-start sm:items-center space-y-2 sm:space-y-0 sm:space-x-4 w-full sm:w-auto">
            <a
              href="admin.html"
              class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 sm:px-4 rounded-lg transition text-sm sm:text-base w-full sm:w-auto text-center"
            >
              <i class="material-icons mr-1 sm:mr-2 text-sm sm:text-base">settings</i>Admin
            </a>
            <button
              id="toggleHistorico"
              class="bg-gray-600 hover:bg-gray-700 text-white px-3 py-2 sm:px-4 rounded-lg transition text-sm sm:text-base w-full sm:w-auto"
            >
              <i class="material-icons mr-1 sm:mr-2 text-sm sm:text-base">history</i>Histórico
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Filters -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6">
      <div class="bg-white rounded-lg shadow mb-4 sm:mb-6">
        <!-- Filter Header -->
        <div class="p-3 sm:p-4 border-b border-gray-200">
          <div class="flex flex-col lg:flex-row lg:items-center justify-between gap-3 lg:gap-0">
            <button 
              id="toggleFilters" 
              class="flex items-center justify-center lg:justify-start space-x-2 text-base sm:text-lg font-semibold text-gray-800 hover:text-gray-600 transition-colors"
            >
              <i id="filterToggleIcon" class="material-icons transition-transform rotated">expand_more</i>
              <span>Filtros</span>
            </button>
            
            <!-- Active Filters Display -->
            <div id="activeFiltersContainer" class="flex flex-col lg:flex-row lg:items-center gap-2 lg:gap-4">
              <div id="activeFilterFlags" class="flex flex-wrap gap-1 sm:gap-2 justify-center lg:justify-end">
                <!-- Active filter flags will be displayed here -->
              </div>
              <button 
                id="clearAllFilters" 
                class="text-sm text-gray-500 hover:text-gray-700 hidden self-center lg:self-auto"
                title="Limpar todos os filtros"
              >
                <i class="material-icons text-base">clear_all</i>
              </button>
            </div>
          </div>
        </div>

        <!-- Filter Content (Collapsible) -->
        <div id="filterContent" class="filter-content">
          <div class="p-4 sm:p-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
              <!-- Categoria -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Categoria</label
                >
                <select
                  id="filterCategoria"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm sm:text-base"
                >
                  <option value="">Todas</option>
                  <option value="provas">Provas</option>
                  <option value="trabalhos">Trabalhos</option>
                  <option value="comunicados">Comunicados</option>
                  <option value="noticias">Notícias</option>
                  <option value="divulgacao">Divulgação</option>
                </select>
              </div>

              <!-- Urgência -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Urgência</label
                >
                <select
                  id="filterUrgencia"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm sm:text-base"
                >
                  <option value="">Todas</option>
                  <option value="alta">Alta</option>
                  <option value="media">Média</option>
                  <option value="baixa">Baixa</option>
                </select>
              </div>

              <!-- Matéria -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Matéria</label
                >
                <select
                  id="filterMateria"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm sm:text-base"
                >
                  <option value="">Todas as matérias</option>
                  <!-- Matérias serão carregadas dinamicamente via JavaScript -->
                </select>
              </div>

              <!-- Dependência -->
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2"
                  >Dependência</label
                >
                <select
                  id="filterDependencia"
                  class="w-full border border-gray-300 rounded-md px-3 py-2 text-sm sm:text-base"
                >
                  <option value="">Todos</option>
                  <option value="true">Dependência</option>
                  <option value="false">Regular</option>
                </select>
              </div>
            </div>

            <div class="mt-4 flex flex-col sm:flex-row justify-between gap-3 sm:gap-0">
              <button id="clearFilters" class="text-gray-600 hover:text-gray-800 text-sm sm:text-base">
                Limpar Filtros
              </button>
              <button
                id="applyFilters"
                class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm sm:text-base"
              >
                Aplicar
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Content Area -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-6 sm:pb-8">
      <!-- Avisos Ativos -->
      <div id="aviosAtivos" class="mb-6 sm:mb-8">
        <h2 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4 px-2 sm:px-0">Avisos Ativos</h2>
        <div id="avisosList" class="space-y-3 sm:space-y-4">
          <!-- Avisos serão carregados aqui dinamicamente -->
        </div>
      </div>

      <!-- Histórico -->
      <div id="avisoHistorico" class="hidden">
        <h2 class="text-lg sm:text-xl font-semibold mb-3 sm:mb-4 px-2 sm:px-0">Histórico</h2>
        <div id="historicoList" class="space-y-3 sm:space-y-4">
          <!-- Histórico será carregado aqui dinamicamente -->
        </div>
      </div>
    </div>

    <!-- Loading Spinner -->
    <div
      id="loadingSpinner"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50 p-4"
    >
      <div class="bg-white p-4 sm:p-6 rounded-lg max-w-sm w-full mx-4">
        <div
          class="animate-spin rounded-full h-10 w-10 sm:h-12 sm:w-12 border-b-2 border-blue-600 mx-auto"
        ></div>
        <p class="mt-3 sm:mt-4 text-center text-sm sm:text-base">Carregando...</p>
      </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/firebase-config.js"></script>
    <script type="module" src="js/app.js"></script>
  </body>
</html>
